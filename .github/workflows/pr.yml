name: pr

on:
  pull_request_target:
    types: [opened, synchronize, reopened, ready_for_review, review_requested, edited] # https://bit.ly/3FEj9D4
    branches: [master, main]

jobs:
  check-user-star:
    name: Check the user's star
    runs-on: ubuntu-latest
    steps:
      - {uses: gacts/is-stargazer@v1, with: {username: '${{ github.event.pull_request.user.login }}'}, id: check-star}

      - if: steps.check-star.outputs.is-stargazer != 'true'
        uses: actions/github-script@v6
        with:
          script: core.setFailed('â­ Please, star this repository!')

  checklist:
    name: Message a checklist to the PR
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    steps:
      - uses: thollander/actions-comment-pull-request@v2
        with:
          message: |
            Your PR has been created! Please now wait for a maintainer to approve it.

            > ### Made a mistake in the record?
            >
            > Don't worry, you can edit the changes in your repo and they should automatically be added to this PR.

            Please, make sure that your PR passes the following checklist:

            - â­ You have starred this repository
            - ðŸ—’ The file with your subdomain has a `.json` extension, doesn't contain comments (`// ...`), and is well formatted (indent size - 2 spaces)
            - ðŸ‘¤ There is sufficient information in the `owner` field
            - ðŸ“‹ You have clearly described a reason for the domain registration (and what you plan to use it for) in the PR description
            - ðŸ”— The website is reachable and a link to it is in the PR description
            - âœ… All CI checks are passed

            After that, feel free to mark this PR as **ready for review**:

            ![ready-for-review](https://user-images.githubusercontent.com/7326800/213099601-ea030ae9-4d18-43a4-bcd9-07cc093be9a0.png)

            > - [ ] Toggle this checkbox to re-run the stargazer checking
          comment_tag: ID:CHECKLIST
